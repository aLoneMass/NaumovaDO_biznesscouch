# Телеграм бот Наумова

Телеграм бот для сбора контактных данных и запросов от пользователей с автоматической отправкой резервных копий базы данных.

## Функциональность

### Для пользователей:
- Приветствие и запрос контакта
- Сбор запросов в различных форматах (текст, фото, голосовые, видеокружки)
- Возможность изменить или завершить запрос

### Для администраторов:
- Команды в меню справа от строки ввода
- Просмотр всех пользователей (/show_users)
- Просмотр сегодняшних регистраций (/show_today)
- Автоматическое получение резервных копий базы данных

## Установка и настройка

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Создание бота в Telegram

1. Найдите @BotFather в Telegram
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота
4. Сохраните полученный токен

### 3. Настройка конфигурации

1. Скопируйте файл `config.env.example` в `.env`:
```bash
cp config.env.example .env
```

2. Отредактируйте файл `.env`:
```env
# Токен бота от @BotFather
BOT_TOKEN=your_bot_token_here

# ID администраторов (через запятую)
ADMINS=123456789,987654321

# ID для отправки резервных копий
BACKUPTO=123456789
```

### 4. Получение Telegram ID

Для получения вашего Telegram ID:
1. Найдите бота @userinfobot в Telegram
2. Отправьте ему любое сообщение
3. Скопируйте ваш ID из ответа

### 5. Запуск бота

```bash
python bot.py
```

## Структура проекта

```
├── bot.py                 # Основной файл бота
├── database.py            # Модуль для работы с базой данных
├── keyboards.py           # Клавиатуры и кнопки
├── backup_service.py      # Сервис резервных копий
├── requirements.txt       # Зависимости Python
├── config.env.example     # Пример конфигурации
├── README.md             # Документация
└── naumovado.db          # База данных (создается автоматически)
```

## База данных

База данных SQLite (`naumovado.db`) содержит таблицу `users` со следующими полями:
- `id` - автоинкрементный ID
- `telegram_id` - ID пользователя в Telegram
- `first_name` - имя пользователя
- `last_name` - фамилия пользователя
- `phone` - номер телефона
- `registration_timestamp` - время регистрации
- `request` - запрос пользователя

## Автоматические резервные копии

Бот автоматически отправляет резервную копию базы данных каждый день в 21:00 на указанный в `BACKUPTO` ID.

## Команды бота

- `/start` - начало работы с ботом
- `/help` - справка по использованию бота

### Команды для администраторов:
- `/show_users` - показать всех пользователей
- `/show_today` - показать сегодняшние регистрации

## Требования

- Python 3.8+
- Доступ к интернету
- Токен Telegram бота
- Telegram ID администраторов

## Безопасность

- Все конфиденциальные данные хранятся в файле `.env`
- База данных защищена от SQL-инъекций
- Доступ к админским функциям ограничен по ID

## Поддержка

При возникновении проблем проверьте:
1. Правильность токена бота
2. Корректность Telegram ID в конфигурации
3. Наличие всех зависимостей
4. Права доступа к файлам 